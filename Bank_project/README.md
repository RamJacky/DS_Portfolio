# Прогнозирование оттока клиентов Банка

## Описание проекта:
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых. 
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Нам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

Необходимо построить модель с предельно большим значением F1-меры и измерить AUC-ROC, сравнивая её значение с F1-мерой.

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

<br>

## Навыки и инструменты:
`Машинное обучение`
`Классификация`
`Pandas` 
`Scikit-learn`
`Matplotlib` 
`Seaborn`
`Pipeline`
`GridSearchCV`
`make_column_transformer`
`OneHotEncoder`
`OrdinalEncoder`
`StandardScaler`

<br>

## Проделанная работа:
- Был проведен предварительный анализ данных.
- Удалены данные не несущие полезной для задачи информации. 
- Обработаны категориальные признаки и проведена стандартизация численных признаков с использованием make_column_transformer.
- Проведен выбор модели МО, подбор гиперпараметров с помощью GridSearchCV.
- Использовано 3 метода борьбы с дисбалансом классов.

<br>

## Вывод:

1. Перед началом исследования данные были подготовлены:
    - удалены признаки, которые не несут ценности для обучения модели,
    - обработаны пропущенные значения,
    - исходный датафрейм был разделён на две выборки: обучающую (75%) и тестовую (25%).

<br>

2. В исследовании участвовали три различные алгоритма классификации: Дерево решений (Decision Tree), Случайный лес (Random Forest) и Логистическая регрессия
3. (Logistic Regression). У каждой модели менялись гиперпараметры, чтобы добиться наиболее высокой оценки качества. 


    Итоговый список признаков для обучения моделей:
    - `geography` - страна проживания,
    - `gender` - пол,
    - `credit_score` - кредитный рейтинг,
    - `age` - возраст,
    - `tenure` - сколько лет человек является клиентом банка,
    - `balance` - баланс на счете,	
    - `num_of_products` - количество продуктов банка, используемых клиентом,
    - `estimated_salary` - предполагаемая зарплата,
    - `has_cr_card` - наличие кредитной карты,
    - `is_active_member` - активность клиента.
    
    Целевой признак:
    - `exited` - факт ухода клиента из банка.
    
    
    Перед началом обучения:
    - для Logistic Regression количественные признаки были масштабированы, а категориальные закодированы методом прямого кодирования (One-Hot Encoding) с 
использованием pipeline,
    - для Random Forest и Decision Tree количественные признаки были масштабированы, а категориальные закодированы методом OrdinalEncoder с использованием pipeline.

<br>

3. Обучение моделей проводилось как на несбалансированных исходных данных, так и с применением методов борьбы с дисбалансом:
    - взвешивание классов, 
    - увеличение выборки (Upsampling),
    - уменьшение выборки (Downsampling).

    <br>

    Сводная таблица исследованных моделей и их метрики на кросс-валидации:

    <br>
    
    <img width="800" alt="Screenshot_1" src="https://github.com/RamJacky/DS_Portfolio/blob/main/Bank_project/attachments/bank_1.png">

    <br>


4. По итогам исследования был сделан вывод, что для прогнозирования ухода клиента из банка наиболее подходящей моделью является модель, построенная на 
**алгоритме Случайного леса (Random Forest) с количеством деревьев 210 и максимальной глубиной дерева 6**. Такой результат был достигнут с применением 
**метода увеличения выборки (Upsampling)**.

    <br>

    <img width="800" alt="Screenshot_2" src="https://github.com/RamJacky/DS_Portfolio/blob/main/Bank_project/attachments/bank_2.png">

    <br>
    
    Модель верно предсказывает положительный класс примерно в 50% случаев. Наибольший вклад в обучение модели вносят признаки: возраст клиента, количество продуктов,
    активность пользователя и баланс на счете.

    <br>
    
    <img width="800" alt="Screenshot_79" src="https://github.com/RamJacky/DS_Portfolio/blob/main/Bank_project/attachments/bank_3.png">

    <br>

6. Итоговое значение качества модели F1-мера на тестовой выборке составляет 0.63. Модель характеризуется высоким показателем полноты = 0.67 (min = 0, max = 1),
 поэтому она с высокой вероятностью предскажет уход клиента из банка. С точки зрения бизнеса полученная модель поможет маркетологам лучше определять килентов,
 которые могут уйти в ближайшее время. Для улучшения модели следует использовать данные, отражающие отношения клиента с банком в динамике.
