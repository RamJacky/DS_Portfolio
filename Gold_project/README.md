# Восстановление золота из руды

- Файл Gold содержит проект без комментариев ревьювера.
- Файл Gold_withRewiew содержит проект с комментариями ревьювера.

## Описание проекта:
Компания «Цифры» разрабатывает решения для эффективной работы промышленных предприятий. Необходимо подготовить прототип модели машинного обучения. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. В нашем распоряжении данные с параметрами добычи и очистки. 

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Требуется:

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.
<br>

**Технологический процесс:**
- `Rougher feed` — исходное сырье;
- `Rougher additions (или reagent additions)` — флотационные реагенты: Xanthate, Sulphate, Depressant;

    - Xanthate — ксантогенат (промотер, или активатор флотации);
    - Sulphate — сульфат (на данном производстве сульфид натрия);
    - Depressant — депрессант (силикат натрия).
    
    
- `Rougher process` — флотация;
- `Rougher tails` — отвальные хвосты;
- `Float banks` — флотационная установка;
- `Cleaner process` — очистка;
- `Rougher Au` — черновой концентрат золота;
- `Final Au` — финальный концентрат золота.

<br>

**Параметры этапов:**
- `air amount` — объём воздуха;
- `fluid levels` — уровень жидкости;
- `feed size` — размер гранул сырья;
- `feed rate` — скорость подачи.

<br>

Нужно спрогнозировать сразу две величины:
- эффективность обогащения чернового концентрата `rougher.output.recovery`;
- эффективность обогащения финального концентрата `final.output.recovery`.

<br>

## Навыки и инструменты:
`Машинное обучение`
`Регрессия`
`EDA`
`Pandas` 
`NumPy`
`Scikit-learn`
`Matplotlib` 
`Seaborn`
`Pipeline`
`GridSearchCV`
`make_column_transformer`
`StandardScaler`
`RandomForestRegressor`
`LinearRegression`
`CatBoostRegressor`

<br>

## Проделанная работа:
- Был проведен предварительный анализ данных.
- Сделан EDA.
- Построена модель, которая предсказывает коэффициент восстановления золота из золотосодержащей руды на основе данных с параметрами добычи и очистки.
- Проведена стандартизация численных признаков с использованием make_column_transformer.
- Проведен выбор модели МО, подбор гиперпараметров с помощью GridSearchCV.
- Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

<br>

## Вывод:

1)

- Данные были проанализированы. 
- Показатель эффективности обогащения рассчитан корректно. 
- Были удалены пропуски данных.

2)

- Проанализированы концентрации металлов (Au, Ag, Pb), а также суммарные концентрации веществ на всех стадиях очистки.

- Рассмотрены распределения гранул сырья на входе технологического процесса для обучающей и тестовой выборок. Двусторонний t-test показал, что распределения не сильно отличаются друг от друга при уровне значимости 0.01 (p-value = 0.014).

- Анализ суммарных концентраций подтвердил наличие аномальных данных. Объекты представляющие собой выбросы с помощью фильта Хампеля были удалены из тренировочной выборки. Суммарно было удалено 13% от изначальных данных.

3)

- Данные обучены на моделях RandomForestRegressor и DecisionTreeRegressor.
- Был применен GridSearchCV для поиска оптимальных гиперпараметров.
- Лучший результат дала модель DecisionTreeRegressor.
- Итоговое sMAPE, предсказанное на тестовой выборке составило 9.2 %.
- sMAPE на константоной модели сопоставимо с выбранной моделью и равняется примерно 9.4 %.
