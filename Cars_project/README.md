# Определение стоимости автомобилей

## Описание проекта:
Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать 
рыночную стоимость своего автомобиля. В нашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. 
Необходимо построить модель для определения стоимости автомобиля. 

Заказчику важны:

- качество предсказания;
- скорость предсказания;
- время обучения.

<br>

**Признаки:**
- `DateCrawled` — дата скачивания анкеты из базы;
- `VehicleType` — тип автомобильного кузова;  
- `RegistrationYear` — год регистрации автомобиля;
- `Gearbox` — тип коробки передач;
- `Power` — мощность (л. с.);
- `Model` — модель автомобиля;
- `Kilometer` —  пробег (км);
- `RegistrationMonth` — месяц регистрации автомобиля;
- `FuelType` — тип топлива;  
- `Brand` —  марка автомобиля;
- `Repaired` —  была машина в ремонте или нет;
- `DateCreated` — дата создания анкеты;
- `NumberOfPictures` — количество фотографий автомобиля;
- `PostalCode` —  почтовый индекс владельца анкеты (пользователя);
- `LastSeen` — дата последней активности пользователя.

<br>

**Целевой признак:**
- `Price` —  цена (евро).

<br>

## Навыки и инструменты:
`Машинное обучение`
`Регрессия`
`Предобработка данных`
`Pandas` 
`NumPy`
`Scikit-learn`
`Matplotlib` 
`Seaborn`
`Pipeline`
`GridSearchCV`
`make_column_transformer`
`StandardScaler`
`RandomForestRegressor`
`LinearRegression`
`CatBoostRegressor`

<br>

## Проделанная работа:
- Был проведен предварительный анализ данных.
- Сделан EDA.
- Построена модель, которая предсказывает стоимость автомобиля на основе данных, введеных пользователем.
- Проведена стандартизация численных признаков и кодировка категориальных признаков с использованием make_column_transformer.
- Проведен выбор модели МО, подбор гиперпараметров с помощью GridSearchCV.

<br>

## Вывод:

Для заказчика были важны следующие критерии: качество предсказания, время обучения модели и время предсказания модели.


1. В нашем распоряжении были данные по 354369 автомобилям, каждый из которых описывается 16-ю признаками (7 количественных, 6 категориальных и 3 временных).

<br>

2. Перед началом исследования данные были подготовлены. После предобработки было удалено 32% всех данных:
    - обработаны пропущенные и аномальные значения,
    - удалены дубликаты и неинформативные признаки,
    - было выявлено, что наибольшее влияние на целевой признак оказывают признаки: год регистрации автомобиля, мощность и модель автомобиля.

   <br>
      
   <img width="500" alt="Screenshot_1" src="https://github.com/RamJacky/DS_Portfolio/blob/main/Cars_project/attachments/cars_1.png">

   <br>

3. В исследовании участвовали четыре различные алгоритма классификации: Линейная регрессия (Linear Regression), Случайный лес (Random Forest Regressor), 
Градиентный бустинг (Cat Boost Regressor), Стохастический градиентный бустинг (LGBM Regressor). У каждой модели менялись гиперпараметры,
 чтобы добиться наиболее высокой оценки качества.


    Итоговый список признаков для обучения моделей:
    - `registration_year` - год регистрации автомобиля,
    - `gear_box` - тип коробки передач,
    - `power` - мощность (л. с.),
    - `car_model` - модель автомобиля,
    - `kilometers` - пробег (км),
    - `fuel_type` - тип топлива,
    - `repaired` - была машина в ремонте или нет.

    Целевой признак:
    - `car_price` - стоимость автомобиля (евро).


    Перед началом обучения:
    - исходный датафрейм был разделён на две выборки: обучающую (75%) и тестовую (25%),
    - для Linear Regression количественные признаки были масштабированы, а категориальные закодированы методом прямого кодирования (One-Hot Encoding) с 
использованием pipeline,
    - для Random Forest Regressor количественные признаки были масштабированы, а категориальные закодированы методом OrdinalEncoder с использованием pipeline,
    - для Cat Boost Regressor и LGBM Regressor категориальные признаки были закодированы с использованием внутренних кодировщиков.


    Сводная таблица исследованных моделей и их метрики на кросс-валидации:

   <br>
   
   <img width="800" alt="Screenshot_2" src="https://github.com/RamJacky/DS_Portfolio/blob/main/Cars_project/attachments/cars_2.png">

   <br>

4. Оценкой качества модели была выбрана метрика RSME - среднеквадратичная ошибка, которая сообщает нам среднее расстояние между прогнозируемыми значениями из модели
 и фактическими значениями в наборе данных. При анализе моделей также учитывались время обучения и время предсказания модели.

<br>

5. По итогам исследования был сделан вывод, что для определения рыночной стоимости автомобиля наиболее подходящей моделью является модель, построенная на
 **алгоритме стохастического градиентного бустинга (Light GBM) с количеством деревьев 460, глубиной дерева None и скоростью обучения 0.1**. 

   Итоговое значение качества модели на тестовой выборке RSME = 1612. Модель характеризуется высоким временем предсказания и обучения.

   <br>
   
   <img width="800" alt="Screenshot_3" src="https://github.com/RamJacky/DS_Portfolio/blob/main/Cars_project/attachments/cars_3.png">

   <br>

   Наибольший вклад в обучение модели вносят признаки: год регистрации автомобиля, мощность и модель.

   <br>
   
   <img width="800" alt="Screenshot_4" src="https://github.com/RamJacky/DS_Portfolio/blob/main/Cars_project/attachments/cars_4.png">

   

   <br>
   

   
